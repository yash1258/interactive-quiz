<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Physics Monograph: SHM & Surface Tension</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Scholarly Neutrals -->
    <!-- Application Structure Plan: A dual-topic SPA with top-level navigation to switch between 'Simple Harmonic Motion' and 'Surface Tension'. This structure immediately organizes the dense content into two distinct, manageable themes. Within SHM, an interactive dashboard with a central chart and sliders is used for exploring core kinematic relationships, while a tabbed component allows for focused exploration of different physical systems (pendulums, springs). This is more engaging than linear text. For Surface Tension, a similar card-based explorer is used for key phenomena, complemented by an interactive simulator for capillarity, turning abstract formulas into a hands-on experiment. This thematic, component-based architecture prioritizes user-driven exploration and discovery over passive reading, making the complex theoretical content more digestible and intuitive. -->
    <!-- Visualization & Content Choices: 
        - SHM Kinematics: Report Info -> x, v, a phase relationships. Goal -> Compare. Viz -> Multi-line Chart.js plot. Interaction -> Time slider updates chart and value cards in real-time. Justification -> Visually demonstrates the π/2 phase shifts more effectively than static graphs. Library -> Chart.js.
        - Physical Oscillators: Report Info -> Formulas for different pendulums/springs. Goal -> Organize & Inform. Viz -> HTML/CSS diagrams in a tabbed interface. Interaction -> Clicking tabs reveals the relevant system diagram and formula. Justification -> Breaks down a long section into focused, visually-supported chunks. Method -> HTML/CSS/JS.
        - Resonance: Report Info -> Amplitude dependence on driving frequency and damping. Goal -> Change. Viz -> Chart.js line chart (Amplitude vs. Frequency). Interaction -> Buttons to select damping levels redraw the curve. Justification -> Clearly shows how damping flattens and shifts the resonance peak. Library -> Chart.js.
        - Capillarity (Jurin's Law): Report Info -> Formula for capillary rise. Goal -> Inform & Explore. Viz -> CSS-based visual of a tube + bar chart for height. Interaction -> Sliders for radius and dropdowns for liquid type update the visual and chart. Justification -> Transforms a static equation into an interactive simulation, enhancing understanding of variable relationships. Method -> HTML/CSS/JS.
        - All diagrams (molecular forces, meniscus, etc.) are built with structured HTML and Tailwind CSS to avoid external assets and maintain a clean, consistent style.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8f7f4;
            color: #4a4a4a;
        }
        .nav-button {
            transition: all 0.3s ease;
        }
        .nav-button.active {
            background-color: #867a6f;
            color: #ffffff;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        }
        .content-card {
            background-color: #ffffff;
            border: 1px solid #e2e8f0;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.05), 0 2px 4px -2px rgb(0 0 0 / 0.05);
            transition: box-shadow 0.3s ease;
        }
        .content-card:hover {
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -2px rgb(0 0 0 / 0.1);
        }
        .tab-button.active {
            border-color: #867a6f;
            color: #867a6f;
            background-color: #f8f7f4;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 40vh;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 400px;
            }
        }
        .latex {
            font-family: "Times New Roman", serif;
            font-style: italic;
        }
        .katex-display { 
            display: block; 
            text-align: center; 
            margin: 1em 0; 
            font-size: 1.2em;
        }
    </style>
</head>
<body class="antialiased">

    <div class="min-h-screen flex flex-col">
        <header class="bg-white shadow-md sticky top-0 z-10">
            <div class="container mx-auto px-4 py-4 flex justify-between items-center">
                <h1 class="text-2xl md:text-3xl font-bold text-[#6c5f5b]">Interactive Physics Monograph</h1>
                <nav id="main-nav" class="flex space-x-2 md:space-x-4 bg-[#e9e4e0] p-1 rounded-full">
                    <button data-target="shm" class="nav-button px-3 py-2 md:px-6 md:py-2 text-sm md:text-base font-semibold rounded-full active">Simple Harmonic Motion</button>
                    <button data-target="surface-tension" class="nav-button px-3 py-2 md:px-6 md:py-2 text-sm md:text-base font-semibold rounded-full">Surface Tension</button>
                </nav>
            </div>
        </header>

        <main class="flex-grow container mx-auto p-4 md:p-8">
            
            <div id="shm-content" class="space-y-8">
                <section class="content-card p-6">
                    <h2 class="text-3xl font-bold text-[#6c5f5b] mb-4">The Theory of Simple Harmonic Motion</h2>
                    <p class="text-lg text-gray-600">This section deconstructs Simple Harmonic Motion (SHM), the fundamental model for oscillatory phenomena. Through interactive visualizations, you can explore the core mathematical principles, the interplay of kinematic variables like displacement, velocity, and acceleration, and the conservation of energy. The goal is to build an intuitive understanding of why SHM appears in so many disparate physical systems, from mechanical springs to electrical circuits.</p>
                </section>

                <section class="content-card p-6">
                    <h3 class="text-2xl font-bold text-[#6c5f5b] mb-4">Kinematics & Energy Dashboard</h3>
                    <p class="mb-6 text-gray-600">Use the slider below to advance time through one full oscillation. Observe how displacement, velocity, and acceleration change in relation to each other. The chart visualizes their sinusoidal nature and phase differences, while the cards display their instantaneous values. This interactive tool demonstrates the core calculus-based relationships and the continuous exchange between kinetic and potential energy that defines SHM.</p>
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-4 mb-6">
                        <div id="displacement-card" class="p-4 bg-blue-50 rounded-lg text-center">
                            <h4 class="font-semibold text-blue-800">Displacement (x)</h4>
                            <p class="text-3xl font-bold text-blue-600">10.00 m</p>
                        </div>
                        <div id="velocity-card" class="p-4 bg-green-50 rounded-lg text-center">
                            <h4 class="font-semibold text-green-800">Velocity (v)</h4>
                            <p class="text-3xl font-bold text-green-600">0.00 m/s</p>
                        </div>
                        <div id="acceleration-card" class="p-4 bg-red-50 rounded-lg text-center">
                            <h4 class="font-semibold text-red-800">Acceleration (a)</h4>
                            <p class="text-3xl font-bold text-red-600">-10.00 m/s²</p>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="shmChart"></canvas>
                    </div>
                    <div class="mt-6">
                        <label for="timeSlider" class="block mb-2 font-medium">Time (t): <span id="timeValue">0.00</span> s</label>
                        <input id="timeSlider" type="range" min="0" max="6.28" step="0.01" value="0" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                    </div>
                </section>

                <section class="content-card p-6">
                    <h3 class="text-2xl font-bold text-[#6c5f5b] mb-4">Physical Manifestations of SHM</h3>
                    <p class="mb-6 text-gray-600">The abstract theory of SHM applies to a wide variety of real-world systems. This explorer allows you to investigate the most common examples. Select a system to see a simplified diagram and its specific formula for the period of oscillation. Notice how each formula follows the general principle: the period is proportional to the square root of an inertia factor divided by a stiffness (or restoring) factor.</p>
                    <div class="flex border-b border-gray-200 mb-4" id="shm-systems-tabs">
                        <button data-target="mass-spring" class="tab-button flex-1 py-2 px-4 text-center font-medium text-gray-500 border-b-2 border-transparent hover:border-gray-300 hover:text-gray-700 active">Mass-Spring</button>
                        <button data-target="simple-pendulum" class="tab-button flex-1 py-2 px-4 text-center font-medium text-gray-500 border-b-2 border-transparent hover:border-gray-300 hover:text-gray-700">Simple Pendulum</button>
                        <button data-target="physical-pendulum" class="tab-button flex-1 py-2 px-4 text-center font-medium text-gray-500 border-b-2 border-transparent hover:border-gray-300 hover:text-gray-700">Physical Pendulum</button>
                        <button data-target="torsional-pendulum" class="tab-button flex-1 py-2 px-4 text-center font-medium text-gray-500 border-b-2 border-transparent hover:border-gray-300 hover:text-gray-700">Torsional Pendulum</button>
                    </div>
                    <div id="shm-systems-content">
                        <!-- Content will be injected by JS -->
                    </div>
                </section>

                <section class="content-card p-6">
                    <h3 class="text-2xl font-bold text-[#6c5f5b] mb-4">Forced Oscillations & Resonance</h3>
                    <p class="mb-6 text-gray-600">Real oscillators are affected by damping and can be driven by external forces. When the driving frequency is close to the system's natural frequency, the amplitude of oscillation can grow dramatically—a phenomenon called resonance. Use the buttons to change the damping level and observe how it affects the sharpness and height of the resonance peak. Low damping leads to a sharp, high-amplitude resonance, critical in applications like radio tuning, while high damping broadens the response, useful in shock absorbers.</p>
                    <div class="chart-container">
                        <canvas id="resonanceChart"></canvas>
                    </div>
                    <div class="mt-6 flex justify-center space-x-4" id="damping-controls">
                        <button data-damping="0.1" class="px-4 py-2 bg-green-500 text-white font-semibold rounded-lg shadow-md hover:bg-green-600 focus:outline-none focus:ring-2 focus:ring-green-400 focus:ring-opacity-75">Low Damping</button>
                        <button data-damping="0.3" class="px-4 py-2 bg-yellow-500 text-white font-semibold rounded-lg shadow-md hover:bg-yellow-600 focus:outline-none focus:ring-2 focus:ring-yellow-400 focus:ring-opacity-75">Medium Damping</button>
                        <button data-damping="0.8" class="px-4 py-2 bg-red-500 text-white font-semibold rounded-lg shadow-md hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-400 focus:ring-opacity-75">High Damping</button>
                    </div>
                </section>
            </div>

            <div id="surface-tension-content" class="space-y-8 hidden">
                <section class="content-card p-6">
                    <h2 class="text-3xl font-bold text-[#6c5f5b] mb-4">The Physics of Liquid Surfaces</h2>
                    <p class="text-lg text-gray-600">This part explores the fascinating world of surface tension, a phenomenon governed by intermolecular forces. We will investigate its molecular origins and its macroscopic consequences, such as the formation of curved surfaces, pressure differences in droplets and bubbles, and the capillary action that allows liquids to defy gravity in narrow tubes. The interactive elements are designed to provide a tangible feel for how these forces shape the behavior of liquids.</p>
                </section>
                
                <section class="content-card p-6">
                    <h3 class="text-2xl font-bold text-[#6c5f5b] mb-4">Molecular Origins</h3>
                    <p class="mb-6 text-gray-600">Surface tension arises from an imbalance of intermolecular forces at a liquid's surface. Molecules in the bulk are pulled equally in all directions (cohesion), resulting in zero net force. Surface molecules, however, have fewer neighbors above them, creating a net inward pull. This causes the surface to contract to the smallest possible area, behaving like a stretched membrane and storing potential energy.</p>
                    <div class="flex flex-col md:flex-row gap-6 text-center">
                        <div class="flex-1 p-4 border border-gray-200 rounded-lg">
                            <h4 class="text-xl font-semibold mb-2">Bulk Molecule</h4>
                            <div class="w-32 h-32 mx-auto bg-blue-100 rounded-full flex items-center justify-center relative">
                                <div class="w-4 h-4 bg-blue-600 rounded-full"></div>
                                <div class="absolute text-blue-600 text-2xl" style="top: 50%; left: 50%; transform: translate(-50%, -200%);">&uarr;</div>
                                <div class="absolute text-blue-600 text-2xl" style="top: 50%; left: 50%; transform: translate(-50%, 100%);">&darr;</div>
                                <div class="absolute text-blue-600 text-2xl" style="top: 50%; left: 50%; transform: translate(-200%, -50%);">&larr;</div>
                                <div class="absolute text-blue-600 text-2xl" style="top: 50%; left: 50%; transform: translate(100%, -50%);">&rarr;</div>
                            </div>
                            <p class="mt-4 text-gray-600">Forces are balanced. Net force is zero.</p>
                        </div>
                        <div class="flex-1 p-4 border border-gray-200 rounded-lg">
                            <h4 class="text-xl font-semibold mb-2">Surface Molecule</h4>
                            <div class="w-32 h-32 mx-auto bg-cyan-100 rounded-full flex items-center justify-center relative">
                                <div class="w-4 h-4 bg-cyan-600 rounded-full"></div>
                                <div class="absolute text-cyan-800 text-3xl font-bold" style="top: 50%; left: 50%; transform: translate(-50%, 70%);">&darr;</div>
                                <div class="absolute text-cyan-600 text-xl" style="top: 50%; left: 50%; transform: translate(-150%, -50%);">&larr;</div>
                                <div class="absolute text-cyan-600 text-xl" style="top: 50%; left: 50%; transform: translate(50%, -50%);">&rarr;</div>
                            </div>
                            <p class="mt-4 text-gray-600">Net inward force. Higher potential energy.</p>
                        </div>
                    </div>
                </section>

                <section class="content-card p-6">
                    <h3 class="text-2xl font-bold text-[#6c5f5b] mb-4">Macroscopic Consequences</h3>
                    <p class="mb-6 text-gray-600">The drive to minimize surface area leads to observable phenomena. The pressure inside a curved surface is higher than outside (Young-Laplace equation), and the interaction with solid surfaces (wetting) is governed by the angle of contact. Explore these key concepts below.</p>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <div class="p-4 border border-gray-200 rounded-lg">
                            <h4 class="text-lg font-semibold">Excess Pressure: Liquid Drop</h4>
                            <p class="text-gray-600 mb-2">Pressure inside is higher due to one surface interface.</p>
                            <div class="katex-display text-gray-800"><span class="latex">&Delta;P = 2&gamma;/r</span></div>
                        </div>
                        <div class="p-4 border border-gray-200 rounded-lg">
                            <h4 class="text-lg font-semibold">Excess Pressure: Soap Bubble</h4>
                            <p class="text-gray-600 mb-2">Pressure is even higher due to two surface interfaces (inner and outer).</p>
                             <div class="katex-display text-gray-800"><span class="latex">&Delta;P = 4&gamma;/r</span></div>
                        </div>
                        <div class="p-4 border border-gray-200 rounded-lg">
                            <h4 class="text-lg font-semibold">Angle of Contact</h4>
                            <p class="text-gray-600 mb-2">Determines wetting. Acute angle (<90°) for wetting, obtuse (>90°) for non-wetting.</p>
                             <div class="katex-display text-gray-800"><span class="latex">&gamma;<sub class="latex">sv</sub> = &gamma;<sub class="latex">sl</sub> + &gamma;<sub class="latex">lv</sub> cos&theta;</span></div>
                        </div>
                    </div>
                </section>
                
                <section class="content-card p-6">
                    <h3 class="text-2xl font-bold text-[#6c5f5b] mb-4">Interactive Capillarity Simulator</h3>
                    <p class="mb-6 text-gray-600">Capillary action is the rise or fall of liquids in narrow tubes, driven by surface tension. This simulator demonstrates Jurin's Law. Adjust the tube radius and select different liquids to see how the capillary height changes. The visualization and chart update in real time, showing that the height is inversely proportional to the tube's radius and dependent on the liquid's properties (surface tension, density, and contact angle).</p>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-center">
                        <div>
                            <div class="mb-4">
                                <label for="liquidSelector" class="font-medium">Liquid:</label>
                                <select id="liquidSelector" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500">
                                    <option value="water" selected>Water on Glass</option>
                                    <option value="mercury">Mercury on Glass</option>
                                </select>
                            </div>
                            <div>
                                <label for="radiusSlider" class="font-medium">Tube Radius (r): <span id="radiusValue">0.50</span> mm</label>
                                <input id="radiusSlider" type="range" min="0.2" max="1.5" step="0.01" value="0.5" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer mt-1">
                            </div>
                            <div class="mt-4 text-center bg-gray-100 p-3 rounded-lg">
                                <h4 class="font-semibold">Calculated Height (h)</h4>
                                <p id="capillaryHeight" class="text-2xl font-bold text-[#867a6f]">29.71 mm</p>
                            </div>
                        </div>
                        <div class="flex justify-center items-end h-64 bg-gray-50 border-b-4 border-gray-300 relative">
                             <div id="capillaryTube" class="w-24 bg-blue-100 border-l-2 border-r-2 border-gray-400 relative">
                                <div id="liquidColumn" class="w-full bg-blue-400 absolute bottom-0 transition-all duration-300 ease-in-out"></div>
                             </div>
                        </div>
                    </div>
                </section>

            </div>
        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const pageState = {
                shm: {
                    amplitude: 10,
                    omega: 1,
                    get period() { return 2 * Math.PI / this.omega; },
                    damping: 0.1,
                    naturalOmega: 5,
                    drivingForce: 100,
                },
                capillarity: {
                    liquids: {
                        water: { name: 'Water on Glass', gamma: 0.0728, rho: 1000, theta: 0, color: 'bg-blue-400' },
                        mercury: { name: 'Mercury on Glass', gamma: 0.486, rho: 13600, theta: 140, color: 'bg-gray-500' }
                    },
                    g: 9.81,
                    radius: 0.0005,
                    currentLiquid: 'water'
                }
            };

            const navButtons = document.querySelectorAll('.nav-button');
            const contentSections = {
                shm: document.getElementById('shm-content'),
                surfaceTension: document.getElementById('surface-tension-content')
            };

            navButtons.forEach(button => {
                button.addEventListener('click', () => {
                    navButtons.forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');
                    const target = button.dataset.target;
                    
                    if (target === 'shm') {
                        contentSections.shm.classList.remove('hidden');
                        contentSections.surfaceTension.classList.add('hidden');
                    } else {
                        contentSections.shm.classList.add('hidden');
                        contentSections.surfaceTension.classList.remove('hidden');
                    }
                });
            });

            const shmSystemsData = {
                'mass-spring': {
                    title: 'Mass-Spring System',
                    description: 'The canonical example of SHM. A mass attached to a spring on a frictionless surface experiences a restoring force proportional to its displacement (Hooke\'s Law).',
                    formula: 'T = 2&pi;&radic;<span style="text-decoration:overline;">&nbsp;m/k&nbsp;</span>',
                    diagram: `<div class="h-40 flex items-center justify-center bg-gray-50 rounded-lg">
                                <div class="w-8 h-20 bg-gray-300 border-2 border-gray-400"></div>
                                <div class="flex flex-col items-center">
                                    <div class="w-24 border-t-2 border-b-2 border-gray-500 h-4 my-1"></div>
                                    <div class="w-20 border-t-2 border-b-2 border-gray-500 h-3 my-1"></div>
                                    <div class="w-16 border-t-2 border-b-2 border-gray-500 h-2 my-1"></div>
                                </div>
                                <div class="w-16 h-16 bg-[#867a6f] rounded-md flex items-center justify-center text-white font-bold">m</div>
                              </div>`
                },
                'simple-pendulum': {
                    title: 'Simple Pendulum',
                    description: 'A point mass suspended by a massless string. For small angles, the tangential component of gravity provides a linear restoring force, resulting in SHM.',
                    formula: 'T = 2&pi;&radic;<span style="text-decoration:overline;">&nbsp;L/g&nbsp;</span>',
                    diagram: `<div class="h-40 flex flex-col items-center justify-center bg-gray-50 rounded-lg">
                                <div class="w-16 h-2 bg-gray-400"></div>
                                <div class="w-0.5 h-24 bg-gray-600"></div>
                                <div class="w-10 h-10 bg-[#867a6f] rounded-full flex items-center justify-center text-white font-bold">m</div>
                              </div>`
                },
                'physical-pendulum': {
                    title: 'Physical Pendulum',
                    description: 'Any rigid body oscillating about a pivot. The period depends on its moment of inertia (I) and the distance (d) from the pivot to the center of mass.',
                    formula: 'T = 2&pi;&radic;<span style="text-decoration:overline;">&nbsp;I/mgd&nbsp;</span>',
                    diagram: `<div class="h-40 flex flex-col items-center justify-center bg-gray-50 rounded-lg">
                                <div class="w-4 h-4 bg-gray-600 rounded-full -mb-2 z-10"></div>
                                <div class="w-24 h-28 bg-[#867a6f] rounded-b-full opacity-80"></div>
                              </div>`
                },
                'torsional-pendulum': {
                    title: 'Torsional Pendulum',
                    description: 'A body suspended by a wire. Twisting it creates a restoring torque proportional to the angular displacement. The motion is angular SHM.',
                    formula: 'T = 2&pi;&radic;<span style="text-decoration:overline;">&nbsp;I/&kappa;&nbsp;</span>',
                    diagram: `<div class="h-40 flex flex-col items-center justify-center bg-gray-50 rounded-lg">
                                <div class="w-24 h-2 bg-gray-400"></div>
                                <div class="w-0.5 h-16 bg-gray-600"></div>
                                <div class="w-32 h-6 bg-[#867a6f] rounded-sm"></div>
                              </div>`
                }
            };

            const shmSystemsTabsContainer = document.getElementById('shm-systems-tabs');
            const shmSystemsContentContainer = document.getElementById('shm-systems-content');

            function updateShmSystemContent(systemId) {
                const data = shmSystemsData[systemId];
                shmSystemsContentContainer.innerHTML = `
                    <div class="p-4">
                        <h4 class="text-xl font-bold text-[#6c5f5b] mb-2">${data.title}</h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 items-center">
                            <div>
                                <p class="text-gray-600 mb-4">${data.description}</p>
                                <div class="text-center bg-gray-100 p-4 rounded-lg">
                                    <p class="text-lg font-semibold">Period of Oscillation:</p>
                                    <p class="text-2xl font-mono text-[#867a6f]">${data.formula}</p>
                                </div>
                            </div>
                            <div>${data.diagram}</div>
                        </div>
                    </div>
                `;
            }

            shmSystemsTabsContainer.addEventListener('click', (e) => {
                if (e.target.classList.contains('tab-button')) {
                    shmSystemsTabsContainer.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
                    e.target.classList.add('active');
                    updateShmSystemContent(e.target.dataset.target);
                }
            });

            updateShmSystemContent('mass-spring');

            const shmCtx = document.getElementById('shmChart').getContext('2d');
            const shmChart = new Chart(shmCtx, {
                type: 'line',
                data: {
                    labels: [],
                    datasets: [
                        { label: 'Displacement (x)', borderColor: 'rgb(59, 130, 246)', tension: 0.1, data: [], fill: false, borderWidth: 2 },
                        { label: 'Velocity (v)', borderColor: 'rgb(16, 185, 129)', tension: 0.1, data: [], fill: false, borderWidth: 2 },
                        { label: 'Acceleration (a)', borderColor: 'rgb(239, 68, 68)', tension: 0.1, data: [], fill: false, borderWidth: 2 }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: { beginAtZero: false }
                    },
                    plugins: {
                        legend: { position: 'top' },
                        tooltip: { mode: 'index', intersect: false }
                    },
                    interaction: {
                        mode: 'nearest',
                        axis: 'x',
                        intersect: false
                    }
                }
            });

            const timeSlider = document.getElementById('timeSlider');
            const timeValue = document.getElementById('timeValue');
            const displacementCard = document.getElementById('displacement-card').querySelector('p');
            const velocityCard = document.getElementById('velocity-card').querySelector('p');
            const accelerationCard = document.getElementById('acceleration-card').querySelector('p');

            function updateSHM(t) {
                const { amplitude, omega } = pageState.shm;
                const x = amplitude * Math.cos(omega * t);
                const v = -amplitude * omega * Math.sin(omega * t);
                const a = -amplitude * omega * omega * Math.cos(omega * t);

                timeValue.textContent = t.toFixed(2);
                displacementCard.textContent = `${x.toFixed(2)} m`;
                velocityCard.textContent = `${v.toFixed(2)} m/s`;
                accelerationCard.textContent = `${a.toFixed(2)} m/s²`;
                
                const pointIndex = shmChart.data.labels.findIndex(label => label >= t);
                if (shmChart.options.plugins.annotation) {
                    shmChart.options.plugins.annotation.annotations.line1.xMin = t;
                    shmChart.options.plugins.annotation.annotations.line1.xMax = t;
                } else {
                    shmChart.update('none');
                }
            }
            
            function populateSHMChart() {
                const { period } = pageState.shm;
                const labels = [];
                const xData = [], vData = [], aData = [];
                for (let t = 0; t <= period; t += period / 100) {
                    labels.push(t.toFixed(2));
                    const { amplitude, omega } = pageState.shm;
                    xData.push(amplitude * Math.cos(omega * t));
                    vData.push(-amplitude * omega * Math.sin(omega * t));
                    aData.push(-amplitude * omega * omega * Math.cos(omega * t));
                }
                shmChart.data.labels = labels;
                shmChart.data.datasets[0].data = xData;
                shmChart.data.datasets[1].data = vData;
                shmChart.data.datasets[2].data = aData;
                timeSlider.max = period.toFixed(2);
                shmChart.update();
            }

            timeSlider.addEventListener('input', (e) => updateSHM(parseFloat(e.target.value)));
            
            populateSHMChart();
            updateSHM(0);

            const resonanceCtx = document.getElementById('resonanceChart').getContext('2d');
            const resonanceChart = new Chart(resonanceCtx, {
                type: 'line',
                data: { labels: [], datasets: [{ label: 'Amplitude', borderColor: '#867a6f', tension: 0.4, data: [], fill: false, borderWidth: 3 }] },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: { title: { display: true, text: 'Driving Frequency (ω)' } },
                        y: { title: { display: true, text: 'Amplitude (A)' }, beginAtZero: true }
                    },
                    plugins: { legend: { display: false } }
                }
            });

            function updateResonanceChart() {
                const { damping, naturalOmega, drivingForce } = pageState.shm;
                const m = 1; 
                const k = m * naturalOmega * naturalOmega;
                const b = damping * 2 * Math.sqrt(k * m);
                
                const labels = [];
                const amplitudeData = [];
                for (let w = 0; w < naturalOmega * 2; w += 0.1) {
                    labels.push(w.toFixed(1));
                    const denominator = Math.sqrt(Math.pow(k - m * w * w, 2) + Math.pow(b * w, 2));
                    amplitudeData.push(drivingForce / denominator);
                }
                resonanceChart.data.labels = labels;
                resonanceChart.data.datasets[0].data = amplitudeData;
                resonanceChart.update();
            }

            document.getElementById('damping-controls').addEventListener('click', (e) => {
                if (e.target.tagName === 'BUTTON') {
                    pageState.shm.damping = parseFloat(e.target.dataset.damping);
                    updateResonanceChart();
                }
            });

            updateResonanceChart();
            
            const liquidSelector = document.getElementById('liquidSelector');
            const radiusSlider = document.getElementById('radiusSlider');
            const radiusValue = document.getElementById('radiusValue');
            const capillaryHeight = document.getElementById('capillaryHeight');
            const liquidColumn = document.getElementById('liquidColumn');

            function updateCapillarity() {
                const { liquids, g, radius, currentLiquid } = pageState.capillarity;
                const liquid = liquids[currentLiquid];
                const h_m = (2 * liquid.gamma * Math.cos(liquid.theta * Math.PI / 180)) / (radius * liquid.rho * g);
                const h_mm = h_m * 1000;
                
                radiusValue.textContent = (radius * 1000).toFixed(2);
                capillaryHeight.textContent = `${h_mm.toFixed(2)} mm`;

                liquidColumn.classList.remove('bg-blue-400', 'bg-gray-500');
                liquidColumn.classList.add(liquid.color);
                
                const maxHeightPx = 250;
                const scale = 5; 
                let displayHeight = Math.abs(h_mm) * scale;
                displayHeight = Math.min(displayHeight, maxHeightPx);
                
                liquidColumn.style.height = `${displayHeight}px`;

                if (h_mm < 0) {
                    liquidColumn.style.bottom = 'auto';
                    liquidColumn.style.top = '0';
                } else {
                    liquidColumn.style.top = 'auto';
                    liquidColumn.style.bottom = '0';
                }
            }

            liquidSelector.addEventListener('change', (e) => {
                pageState.capillarity.currentLiquid = e.target.value;
                updateCapillarity();
            });

            radiusSlider.addEventListener('input', (e) => {
                pageState.capillarity.radius = parseFloat(e.target.value) / 1000;
                updateCapillarity();
            });
            
            updateCapillarity();
        });
    </script>
</body>
</html>
